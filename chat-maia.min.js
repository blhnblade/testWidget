(()=>{"use strict";const e=function(e){return"\n.chat-widget-container * {\n    font-family: 'Inter', 'Segoe UI';\n    box-sizing: border-box;\n    padding: 0px;\n    margin: 0px;\n    border: none;\n    width: auto;\n    min-width: auto;\n    max-width: auto;\n    min-height: auto;\n    max-height: auto;\n    height: auto;\n    background: none;\n    box-shadow: none;\n    color: initial;\n}\n.chat-widget-container textarea:focus{\n    outline: none;\n    border: none;\n    background-color: #F2F3F7;\n    box-shadow: none;\n}\n.hidden {\n    display: none!important;\n}\n.chat-widget-container {\n    position: fixed;\n    bottom: 20px;\n    right: 20px;\n    flex-direction: column;\n    z-index: 1000;\n}\n.chat-bubble{\n    font-size: 30px;\n    line-height: 36px;\n    border-radius: 100%;\n    width: 64px;\n    height: 64px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    background-color: ".concat(e.config?.circle_color||"gray",";\n    animation-name: opacity-emergence;\n    animation-duration: .2s;\n    position: relative;\n}\n.chat-bubble svg{\n    width: 48px;\n    height: 48px;\n    color: rgba(255,255,255,1);\n    display: block;\n    vertical-align: middle;\n}\n.chat-unread-message-icon{\n    position: absolute;\n    top: 0;\n    right: 0;\n    width: 20px;\n    min-width: 20px;\n    max-width: 20px;\n    height: 20px;\n    max-height: 20px;\n    min-height: 20px;\n    border-radius: 50%;\n    background-color: #00D35B;\n    animation-name: opacity-emergence;\n    animation-duration: .2s;\n}\n.chat-popup{\n    height: 70vh;\n    max-height: 70vh;\n    transition: all 0.3s;\n    overflow: hidden;\n    transition-property: all;\n    transition-timing-function: cubic-bezier(0.4,0,0.2,1);\n    transition-duration: 150ms;\n    box-shadow: 0 0 #0000, 0 0 #0000, 0 4px 6px -1px rgba(0, 0, 0, 0.1),\n    0 2px 4px -1px rgba(0, 0, 0, 0.06);\n    border-radius: 6px;\n    font-size: 14px;\n    line-height: 20px;\n    background-color: rgba(255,255,255, 1);\n    width: 384px;\n    max-width: 384px;\n    min-width: 384px;\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    bottom: 80px;\n    right: 0;\n}\n.chat-header{\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 12px 16px;\n    border-top-left-radius: 6px;\n    border-top-right-radius: 6px;\n    background-color: ").concat(e.config?.header_color||"gray","\n}\n.chat-header h3{\n    font-size: 18px;\n    line-height: 28px;\n    font-weight: 500;\n    margin: 0;\n    color: white;\n    user-select: none;\n}\n.chat-header #close-popup{\n    min-width: 24px !important;\n    width: 24px !important;\n    height: 24px !important;\n    min-height: 24px !important;\n    color: rgba(255,255,255,1);\n    border-style: none;\n    cursor: pointer;\n    background-color: transparent;\n    background-image: none;\n    text-transform: none;\n    -webkit-appearance: button;\n    font-family: inherit;\n    font-size: 100%;\n    margin: 0;\n    padding: 0px;\n    text-indent: 0px;\n    text-shadow: none;\n    display: flex;\n    align-items:center;\n    justify-content: center\n    letter-spacing: normal;\n    word-spacing: normal;\n    text-rendering: auto;\n}\n.chat-header button svg{\n    width: 24px;\n    height: 24px;\n}\n.chat-messages{\n    flex: 1 1 0%;\n    padding: 16px;\n    overflow-y: auto;\n    scrollbar-width: none;\n    scrollbar-color: #888 #F2F3F7;\n}\n.chat-messages::-webkit-scrollbar {\n    width: 3px;\n}\n.chat-messages::-webkit-scrollbar-track {\n    background-color: white;\n}\n.chat-messages::-webkit-scrollbar-thumb {\n    background-color: #888;\n    border-radius: 6px;\n}\n.chat-input-container{\n    display: flex;\n    flex-direction: column;\n    row-gap: 10px;\n    border-top: 1px solid var(--border-border-gray-200, #E5E7EB);\n    border-top-width: 1px;\n    border-color: rgba(229,231,235,1);\n    padding: 16px;\n    background: #FFF;\n}\n.chat-input-container-inner{\n    display: flex;\n    column-gap: 16px;\n}\n.chat-input{\n    flex-grow: 1;\n    background-color: #F2F3F7;\n    border-radius: 8px;\n    font-size: 14px;\n    line-height: 20px;\n    font-weight: 400;\n    padding: 8px 44px;\n    outline: none;\n    border: none;\n    resize: none;\n    height: 36px;\n    max-height: 136px;\n    overflow-y: auto;\n    word-break: break-word;\n    scrollbar-width: thin;\n    scrollbar-color: #888 #F2F3F7;\n    user-select: none;\n}\n.chat-stack{\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n}\n.chat-popup .textarea-wrapper{\n    display: flex;\n    position: relative;\n    flex-grow: 1;\n}\n.chat-popup .clip-container {\n    display: flex;\n    position: relative\n}\n.chat-popup .clip-container .clip{\n    position: absolute;\n    bottom: 6px;\n    left: 12px;\n    min-width: 24px;\n    width: 24px;\n    max-width: 24px;\n    min-height: 24px;\n    height: 24px;\n    max-height: 24px;\n    background: none;\n    border: none;\n    cursor: pointer;\n}\n.chat-popup .clip-select{\n    position: absolute;\n    top: calc(-100% - 45px);\n    left: -12px;\n    z-index: 5;\n    padding: 4px;\n    background-color: #fff;\n    border-radius: 8px;\n    box-shadow: 0px 9px 28px 8px #18182A0D, 0px 6px 16px 0px #18182A14, 0px 3px 6px -4px #18182A1F;\n}\n.chat-popup .clip-select .clip-select-item{\n    display: flex;\n    align-items: center;\n    column-gap: 8px;\n    padding: 5px 15px;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    line-height: 22px;\n    color: #18182A;\n    transition-property: background-color;\n    transition-duration: .2s;\n}\n.chat-popup .clip-select .clip-select-item:hover{\n    background-color: #F4F4F6;\n}\n.chat-popup .clip-select + .clip > svg > path{\n    transition-property: fill;\n    transition-duration: .2s;\n}\n.chat-popup .clip-select:not(.hidden) + .clip > svg > path{\n    fill: #2A63EF;\n}\n.chat-popup .record{\n    position: absolute;\n    bottom: 6px;\n    right: 12px;\n    min-width: 24px;\n    width: 24px;\n    max-width: 24px;\n    min-height: 24px;\n    height: 24px;\n    max-height: 24px;\n    background: none;\n    border: none;\n    cursor: pointer;\n}\n.chat-popup .record-wrapper{\n    display: flex;\n    align-items: center;\n    flex-grow: 1;\n}\n.chat-popup .record-container{\n    display: flex;\n    align-items: center;\n    flex-grow: 1;\n    background-color: #F2F3F7;\n    padding: 6px;\n    max-width: 300px;\n    border-radius: 8px;\n    overflow: hidden;\n    position:relative;\n    height: 36px;\n}\n.chat-popup .road{\n    display: flex;\n    flex-direction: row-reverse;\n    align-items: center;\n    position: relative;\n    column-gap: 2px;\n    width: 100%;\n    max-width: 177.5px;\n    overflow: hidden;\n    height: 24px;\n    padding: 4px 0;\n}\n.chat-popup .road .elem{\n    width: 2px;\n    height: 2px;\n    border-radius: 3px;\n    background-color: #568BFC;\n    min-height: 2px;\n    max-height: 16px;\n    display: flex;\n    flex-shrink: 0;\n    transition-property: opacity;\n    transition-duration: .2s;\n}\n.chat-popup .chat-message-user-container .road .elem{\n    background-color: #F0F7FF;\n}\n.chat-popup .road .elem.opacity{\n    opacity: 0.4\n}\n.chat-popup .record-stop{\n    min-width: 24px;\n    width: 24px;\n    max-width: 24px;\n    min-height: 24px;\n    height: 24px;\n    max-height: 24px;\n    background: none;\n    border: none;\n    cursor: pointer;\n    margin-right: 8px;\n}\n.chat-submit-record{\n    margin-left: 16px;\n}\n.chat-popup .clip > svg, .chat-popup .record > svg, .chat-popup .record-stop > svg{\n    width: 100%;\n    height: 100%;\n}\n.chat-popup .audio-play, .chat-popup .audio-stop, .chat-popup .audio-pause{\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 24px;\n    max-width: 24px;\n    min-width: 24px;\n    height: 24px;\n    max-height: 24px;\n    min-height: 24px;\n    background-color: #2963EE;\n    border-radius: 50%;\n    margin-right: 8px;\n}\n.audio-play > svg{\n    width: 16px;\n    height: 16px;\n}\n.timer{\n    min-width: 39px;\n    font-size: 14px;\n    line-height: 20px;\n    color: #192C3D80;\n    margin-left: 8px;\n}\n\n\n\n.chat-input::-webkit-scrollbar {\n    width: 3px;\n}\n.chat-input::-webkit-scrollbar-track {\n    background-color: white;\n}\n.chat-input::-webkit-scrollbar-thumb {\n    background-color: #888;\n    border-radius: 6px;\n}\n.chat-submit{\n    min-width: 36px !important;\n    width: 36px !important;\n    height: 36px !important;\n    min-height: 36px !important;\n    padding: 6px;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    background-color: ").concat(e.config?.send_button_color||"gray",";\n    border: none;\n    align-self: flex-end;\n    cursor: pointer;\n}\n.chat-submit svg{\n    width: 24px;\n    height: 24px;\n    fill: white;\n}\n.chat-message-user{\n    max-width: 80%;\n    color: rgba(255,255,255,1);\n    padding-top: 8px;\n    padding-bottom: 8px;\n    padding-left: 16px;\n    padding-right: 16px;\n    background-color: rgba(31,41,55,1);\n    word-break: break-word;\n    border-radius: 8px 8px 2px 8px;\n    background-color: ").concat(e.config?.user_message_color||"gray",";\n}\n.chat-audio-message-user{\n    display: flex;\n    align-items: center;\n    max-width: 80%;\n    padding: 6px 0px 6px 12px;\n    background-color: rgba(31,41,55,1);\n    border-radius: 8px 8px 2px 8px;\n    background-color: ").concat(e.config?.user_message_color||"gray",";\n}\n.chat-audio-message-user > .message-play-btn, .chat-audio-message-user > .message-pause-btn{\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 40px;\n    max-width: 40px;\n    min-width: 40px;\n    height: 40px;\n    max-height: 40px;\n    min-height: 40px;\n    margin-right: 12px;\n    background-color: #F0F7FF;\n    border-radius: 50%;\n    cursor: pointer;\n    margin-bottom: 4px;\n}\n.chat-audio-message-user .message-audio-container{\n    display: flex;\n    flex-direction: column;\n}\n.message-audio-container .message-audio-duration{\n    font-size: 12px;\n    line-height: 16px;\n    color: #fff;\n    opacity: .6;\n}\n.message-audio-container .road{\n    min-width: 177.5px;\n}\n.chat-message-user-container{\n    display: flex;\n    justify-content: flex-end;\n    margin-bottom: 12px;\n}\n.chat-message-bot-container{\n    display: flex;\n    margin-bottom: 12px;\n}\n.chat-message-bot{\n    max-width: 80%;\n    color: rgba(0,0,0,1);\n    padding-top: 8px;\n    padding-bottom: 8px;\n    padding-left: 16px;\n    padding-right: 16px;\n    background-color: rgba(229,231,235,1);\n    word-break: break-word;\n    border-radius: 8px 8px 8px 2px;\n    background: #F2F3F7;\n}\n@media (max-width: 768px) {\n    .chat-popup {\n    position: fixed;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    max-height: 100%;\n    border-radius: 0;\n    max-width: initial;\n    min-width: initial;\n    }\n    .chat-header{\n    border-radius: 0px;\n    }\n}\n.chat-online{\n    font-size: 14px;\n    line-height: 20px;\n    color: #fff;\n}\n@keyframes opacity-emergence{\n    0%{\n    opacity: 0;\n    }\n    100%{\n    opacity: 1\n    }\n}\n.chat-prints ~ .chat-online{\n    display: none;\n}\n.chat-prints{\n    display: flex;\n    align-items: center;\n    color: #fff;\n}\n.chat-prints-circle-container{\n    display: flex;\n    align-items: center;\n    column-gap: 4px;\n    margin-right: 5px;\n}\n\n.chat-prints-circle{\n    min-width: 3px;\n    width: 3px;\n    max-width: 3px;\n    height: 3px;\n    max-height: 3px;\n    min-height: 3px;\n    border-radius: 50%;\n    background-color: #fff;\n}\n\n.chat-prints-circle-first{\n    animation-name: chat-prints-circle-first;\n    animation-duration: 1.5s;\n    animation-iteration-count: infinite;\n}\n.chat-prints-circle-second{\n    animation-name: chat-prints-circle-second;\n    animation-duration: 1.5s;\n    animation-iteration-count: infinite;\n}\n.chat-prints-circle-third{\n    animation-name: chat-prints-circle-third;\n    animation-duration: 1.5s;\n    animation-iteration-count: infinite;\n}\n.chat-lath{\n    display: flex;\n    align-items: center;\n    align-self: center;\n    column-gap: 4px;\n    text-decoration: none;\n}\n\n.chat-lath-text{\n    font-size: 12px;\n    font-weight: 500;\n    color: #A9ABBA;\n    line-height: 16px;\n}\n\n@keyframes chat-prints-circle-first{\n    0%{\n        transform: scale(1);\n    }\n    16.5%{\n        transform: scale(1.5);\n    }\n    33%{\n        transform: scale(1);\n    }\n    100%{\n        transform: scale(1);\n    }\n    \n}\n@keyframes chat-prints-circle-second{\n    0%{\n        transform: scale(1);\n    }\n    33%{\n        transform: scale(1);\n    }\n    49.5%{\n        transform: scale(1.5);\n    }\n    66%{\n        transform: scale(1);\n    }\n    100%{\n        transform: scale(1);\n    }\n}\n@keyframes chat-prints-circle-third{\n    0%{\n        transform: scale(1);\n    }\n    66%{\n        transform: scale(1);\n    }\n    80.5%{\n        transform: scale(1.5);\n    }\n    99%{\n        transform: scale(1);\n    }\n    100%{\n        transform: scale(1);\n    }\n}\n#close-popup svg path {\n    stroke: #FFF;\n}\n")},n=function(e){return{init(){this.setHandlers()},stream:null,mainMedia:null,chunks:[],stepMS:200,isRecording:!1,isPaused:!1,volumeArrayCurrentAudio:[],resizedArraySound:[],audioObject:new Audio,timerMS:0,timerId:null,maxElemsInRoad:45,audioDuration:0,paintingTimer:null,setHandlers(){this.startRecordHandler(),this.closeRecordHandler(),this.stopRecordHandler(),this.playAudioHandler(),this.pauseAudioHandler(),this.submitAudioMessageHandler()},startRecordHandler(){var n=this;e.recordStart.addEventListener("click",(function(){n.startRecord()}))},closeRecordHandler(){var n=this;e.recordStop.addEventListener("click",(function(){n.closeRecord()}))},stopRecordHandler(){var n=this;e.audioStop.addEventListener("click",(function(){n.stopRecord()}))},playAudioHandler(){var n=this;e.audioPlay.addEventListener("click",(function(){n.playAudio()}))},pauseAudioHandler(){var n=this;e.audioPause.addEventListener("click",(function(){n.pauseAudio()}))},submitAudioMessageHandler(){var n=this;e.chatSubmitRecord.addEventListener("click",(function(){n.submitAudioMessage()}))},async startRecord(){var e=this;try{const n=this.helpers;if(this.stream||(this.stream=await navigator.mediaDevices.getUserMedia({audio:!0})),this.stream){this.isRecording=!0,n.clearRecordRoad(),n.hideChatInputContainerInner(),n.visibleRecordWrapper(),n.clearTimerContainer(),n.visibleAudioStop(),n.hideAudioPlay(),n.hideAudioPause(),this.resetAllVoices(),this.clearAudioObject(),this.chunks=[],this.mainMedia=new MediaRecorder(this.stream),this.mainMedia.ondataavailable=function(n){e.chunks.push(n.data)},this.mainMedia.onstop=function(){clearInterval(t),e.stopTimer()},this.mainMedia.start(),this.startTimer(0),this.mediaStart();const t=setInterval((function(){return e.mediaStart()}),2*this.stepMS)}}catch(e){}},closeRecord(){if(!this.mainMedia)return;const e=this.helpers;this.mainMedia.stop(),this.clearAudioObject(),this.pausePaintingElems(),this.stopTimer(),this.clearState(),this.resetAllVoices(),e.hideRecordWrapper(),e.visibleChatInputContainerInner(),e.hideAudioPlay(),e.hideAudioPause(),e.visibleAudioStop()},stopRecord(){if(!this.mainMedia)return;const e=this.helpers;this.isRecording=!1,this.mainMedia.stop(),this.createResultAudioTrack(),e.hideAudioStop(),e.visibleAudioPlay()},playAudio(){var e=this;const n=this.helpers;if(this.resetAllVoices(),this.isPaused)this.isPaused=!1,n.hideAudioPlay(),n.visibleAudioPause(),this.startTimer(this.timerMS),this.startPaintingElems(),this.audioObject.play();else{this.clearAudioObject();const t=new Blob(this.chunks,{type:"audio/mp3"}),i=new AudioContext;t.arrayBuffer().then((function(a){i.decodeAudioData(a,(function(i){e.audioDuration=i.duration,e.audioObject.src=URL.createObjectURL(t),e.audioObject.load(),e.audioObject.oncanplaythrough=function(){e.audioObject.oncanplaythrough=null,e.audioObject.play(),e.startTimer(),e.startPaintingElems(),n.clearTimerContainer(),n.hideAudioPlay(),n.visibleAudioPause()},e.audioObject.onended=function(){e.audioObject.onended=null,URL.revokeObjectURL(e.audioObject.src),n.visibleAudioPlay(),n.hideAudioPause(),e.stopTimer(),e.audioObject.currentTime=0,e.isPaused=!1,n.transparencyElems()}}))}))}},pauseAudio(){const e=this.helpers;this.isPaused=!0,this.audioObject.pause(),this.pauseTimer(),this.pausePaintingElems(),e.hideAudioPause(),e.visibleAudioPlay()},mediaStart(){var e=this;const n=new MediaRecorder(this.stream);n.ondataavailable=function(t){n.stop(),e.getMaxVolumeFromBlob(t.data).then((function(n){e.isRecording&&(e.insert(n),e.volumeArrayCurrentAudio.push(n))}))},n.start(),setTimeout((function(){return n.stop()}),this.stepMS)},clearAudioObject(){this.audioObject.pause(),this.audioObject.src="",URL.revokeObjectURL(this.audioObject.src)},getMaxVolumeFromBlob:e=>new Promise((function(n,t){const i=new(window.AudioContext||window.webkitAudioContext),a=new FileReader;a.onloadend=function(){const e=a.result;i.decodeAudioData(e,(function(e){const t=i.createBufferSource();t.buffer=e;const a=i.createAnalyser();t.connect(a),a.fftSize=256;const s=a.frequencyBinCount,o=new Uint8Array(s);let r=0;t.start();const c=setInterval((function(){!function(){a.getByteFrequencyData(o);let e=0;for(let n=0;n<s;n++)e+=o[n];const n=e/s;n>r&&(r=n)}()}),100);setTimeout((function(){clearInterval(c),i.close(),n(r>100?100:parseInt(r))}),1e3)}),(function(e){t(e)}))},a.readAsArrayBuffer(e)})),insert(n){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=document.createElement("div");i.innerHTML='<div class="elem '.concat(t.join(" "),'" style="height: ').concat(this.getHeight(n),'px"></div>'),e.recordRoad.prepend(i.firstElementChild)},getHeight:e=>.14*e+2,startTimer(n){var t=this;n=this.timerMS?this.timerMS:0,this.timerId=setInterval((function(){n>=18e3&&(e.audioStop.click(),clearInterval(t.timerId));let i=Math.floor(n/100),a=Math.floor(i/60),s=i%60;a=a<10?"0"+a:a,s=s<10?"0"+s:s,e.timer.textContent="".concat(a,":").concat(s),n++,t.timerMS=n}),10)},pauseTimer(){clearInterval(this.timerId)},stopTimer(){this.timerMS=0,clearInterval(this.timerId)},setNormalizeDurationAudio(){let n=Math.floor(this.audioDuration),t=Math.floor(n/60),i=n%60;t=t<10?"0"+t:t,i=i<10?"0"+i:i,e.timer.textContent="".concat(t,":").concat(i)},createResultAudioTrack(){var e=this;this.helpers.clearRecordRoad(),this.resizedArrayAudio=this.resizeArray(this.volumeArrayCurrentAudio),this.resizedArrayAudio.forEach((function(n){return e.insert(n,["opacity"])}))},resizeArray(e){const n=this.maxElemsInRoad;if(e.length===n)return e;if(e.length<n){const t=[],i=Math.ceil(n/e.length);for(let a of e)for(let e=0;e<i;e++)t.length<n&&t.push(a);return t}{const t=[],i=(e.length-1)/(n-1);for(let a=0;a<n;a++)t.push(e[Math.round(a*i)]);return t}},startPaintingElems(){var n=this;let t=0;const i=Math.floor(this.audioDuration)/this.maxElemsInRoad*1e3,a=[...e.recordRoad.querySelectorAll(".elem.opacity")].reverse();this.paintingTimer=setInterval((function(){t>=e.recordRoad.childElementCount||n.audioObject.paused?clearInterval(n.paintingTimer):(a[t]?.classList?.remove("opacity"),t+=1)}),i)},pausePaintingElems(){clearInterval(this.paintingTimer)},submitAudioMessage(){var n=this;e.audioStop.click(),setTimeout((function(){n.insertAudioMessage(),n.pausePaintingElems(),n.resetAllVoices(),e.recordStop.click()}),0)},getAudioMessage:function(e){const n=document.createElement("div");return n.innerHTML='\n    <div class="chat-message-user-container" data-audio-message>\n        <div class="chat-audio-message-user">\n        <div class="message-play-btn" data-audio-message-play-btn>\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="#2A63EF" width="22" height="25"><g><path d="M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z"></path></g></svg>\n        </div>\n        <div class="message-pause-btn hidden" data-audio-message-pause-btn>\n            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 32 32" width="24" fill="#2A63EF"><defs><style>.cls-1{fill:none;}</style></defs><title/><path d="M12,6H10A2,2,0,0,0,8,8V24a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2Z"/><path d="M22,6H20a2,2,0,0,0-2,2V24a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2Z"/><rect class="cls-1" data-name="&lt;Transparent Rectangle&gt;" height="32" id="_Transparent_Rectangle_" width="32"/></svg>\n        </div>\n        <div class="message-audio-container">\n            <div class="road" data-audio-track></div>\n            <div class="message-audio-duration" data-message-audio-duration>00:00</div>\n        </div>\n        </div>\n    </div>\n    ',n.firstElementChild},createAudioTrackForMessage(e){var n=this;this.resizedArrayAudio.forEach((function(t){return n.insertElemsInReadyAudioMessage(e,t,["opacity"])}))},insertElemsInReadyAudioMessage(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=document.createElement("div");i.innerHTML='<div class="elem '.concat(t.join(" "),'" style="height: ').concat(this.getHeight(n),'px"></div>'),e.querySelector("[data-audio-track]").prepend(i.firstElementChild)},assignAudioMessageData(e){e.audioBlob=[...this.chunks],e.isPaused=!1,e.timerId=null,e.timerMs=0,e.paintingTimer=null},setAudioMessageHandler(e){this.playAudioMessageHandler(e),this.pauseAudioMessageHandler(e)},playAudioMessageHandler(e){var n=this;e.querySelector("[data-audio-message-play-btn]").addEventListener("click",(function(){n.playAudioMessage(e)}))},pauseAudioMessageHandler(e){var n=this;e.querySelector("[data-audio-message-pause-btn]").addEventListener("click",(function(){n.pauseAudioMessage(e)}))},playAudioMessage(e){var n=this;const t=this.helpers;if(t.hidePlayAudioMessage(e),t.visiblePauseAudioMessage(e),this.resetAllVoices(e),this.setInitialStateRecordedAudio(),e.isPaused)e.isPaused=!1,this.audioObject.play(),this.startPaintingAudioMessageElems(e),this.startTimerAudioMessage(e);else{this.checkAndCloseRecord(),this.clearAudioObject();const i=new Blob(e.audioBlob,{type:"audio/mp3"});this.audioObject.src=URL.createObjectURL(i),this.audioObject.load(),this.audioObject.oncanplaythrough=function(){n.audioObject.oncanplaythrough=null,n.audioObject.play(),n.startPaintingAudioMessageElems(e),n.startTimerAudioMessage(e)},this.audioObject.onended=function(){n.audioObject.onended=null,URL.revokeObjectURL(n.audioObject.src),n.stopTimerAudioMessage(e),e.isPaused=!1,t.visiblePlayAudioMessage(e),t.hidePauseAudioMessage(e),t.transparencyElemsAudioMessage(e)}}},pauseAudioMessage(e){const n=this.helpers;n.visiblePlayAudioMessage(e),n.hidePauseAudioMessage(e),e.isPaused=!0,this.pausePaintingAudioMessageElems(e),this.pauseTimerAudioMessage(e),this.audioObject.pause()},async setDurationAudioMessage(e){const n=new Blob(e.audioBlob,{type:"audio/mp3"}),t=new AudioContext,i=await n.arrayBuffer();t.decodeAudioData(i,(function(n){e.audioDuration=n.duration;let t=Math.floor(e.audioDuration),i=Math.floor(t/60),a=t%60;i=i<10?"0"+i:i,a=a<10?"0"+a:a,e.normalizeDuration="".concat(i,":").concat(a),e.querySelector("[data-message-audio-duration]").textContent="".concat(i,":").concat(a)}))},setNormalizeDurationAudioMessage(e){e.querySelector("[data-message-audio-duration]").textContent=e.normalizeDuration},startPaintingAudioMessageElems(e){var n=this;let t=0;const i=Math.floor(e.audioDuration)/this.maxElemsInRoad*1e3,a=[...e.querySelectorAll(".elem.opacity")].reverse();e.paintingTimer=setInterval((function(){t>=e.querySelector("[data-audio-track]").childElementCount||n.audioObject.paused?clearInterval(e.paintingTimer):(a[t]?.classList?.remove("opacity"),t+=1)}),i)},pausePaintingAudioMessageElems(e){clearInterval(e.paintingTimer)},startTimerAudioMessage(e){let n=e.timerMS?e.timerMS:0;e.timerId=setInterval((function(){n>=18e3&&clearInterval(e.timerId);let t=Math.floor(n/100),i=Math.floor(t/60),a=t%60;i=i<10?"0"+i:i,a=a<10?"0"+a:a,e.querySelector("[data-message-audio-duration]").textContent="".concat(i,":").concat(a),n++,e.timerMS=n}),10)},pauseTimerAudioMessage(e){clearInterval(e.timerId)},stopTimerAudioMessage(e){e.timerMS=0,clearInterval(e.timerId)},checkAndCloseRecord(){this.isRecording&&e.recordStop.click()},setInitialStateRecordedAudio(){const n=this.helpers;e.audioPause.click(),n.visibleAudioPlay(),n.hideAudioPause(),this.setNormalizeDurationAudio(),this.stopTimer(),this.isPaused=!1,n.transparencyElems()},async insertAudioMessage(){const n=this.getAudioMessage();this.assignAudioMessageData(n),this.createAudioTrackForMessage(n),this.setAudioMessageHandler(n),await this.setDurationAudioMessage(n),e.chatMessages.appendChild(n),e.chatMessages.scrollTop=e.chatMessages.scrollHeight},resetAllVoices(){var e=this;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.helpers,i=document.querySelectorAll("[data-audio-message]");i.length&&i.forEach((function(a){a!==n&&(t.hidePauseAudioMessage(a),t.visiblePlayAudioMessage(a),e.pausePaintingAudioMessageElems(a),e.stopTimerAudioMessage(a),e.setNormalizeDurationAudioMessage(a),a.timerId=null,a.timerMs=0,a.paintingTimer=0,a.isPaused=!1,a.querySelectorAll("[data-audio-track] .elem").forEach((function(e){return e.classList.add("opacity")})),i.isPaused=!1)}))},clearState(){this.mainMedia=null,this.chunks=[],this.isRecording=!1,this.isPaused=!1,this.volumeArrayCurrentAudio=[],this.resizedArrayAudio=[],this.audioObject=new Audio,this.timerMS=0,this.timerId=null,this.audioDuration=0,this.paintingTimer=null},helpers:{visibleChatInputContainerInner(){e.chatInputContainerInner.classList.remove("hidden")},hideChatInputContainerInner(){e.chatInputContainerInner.classList.add("hidden")},visibleRecordWrapper(){e.recordWrapper.classList.remove("hidden")},hideRecordWrapper(){e.recordWrapper.classList.add("hidden")},clearRecordRoad(){e.recordRoad.innerHTML=""},visibleAudioPlay(){e.audioPlay.classList.remove("hidden")},hideAudioPlay(){e.audioPlay.classList.add("hidden")},visibleAudioStop(){e.audioStop.classList.remove("hidden")},hideAudioStop(){e.audioStop.classList.add("hidden")},visibleAudioPause(){e.audioPause.classList.remove("hidden")},hideAudioPause(){e.audioPause.classList.add("hidden")},clearTimerContainer(){e.timer.textContent="00:00"},transparencyElems(){[...e.recordRoad.children].forEach((function(e){return e.classList.add("opacity")}))},visiblePlayAudioMessage(e){e.querySelector("[data-audio-message-play-btn]").classList.remove("hidden")},hidePlayAudioMessage(e){e.querySelector("[data-audio-message-play-btn]").classList.add("hidden")},visiblePauseAudioMessage(e){e.querySelector("[data-audio-message-pause-btn]").classList.remove("hidden")},hidePauseAudioMessage(e){e.querySelector("[data-audio-message-pause-btn]").classList.add("hidden")},transparencyElemsAudioMessage(e){e.querySelectorAll("[data-audio-track] .elem").forEach((function(e){return e.classList.add("opacity")}))}}}},t=function(e){return{init(){this.setHandlers()},setHandlers(){this.openSelectHandler(),this.selectImageHandler()},openSelectHandler(){e.clip.addEventListener("click",(function(n){n.stopPropagation(),e.clipSelect.classList.toggle("hidden")})),window.addEventListener("click",(function(){e.clipSelect.classList.contains("hidden")||e.clipSelect.classList.add("hidden")}))},selectImageHandler(){e.sendImage.addEventListener("click",(function(){}))}}};function i(){var i=this;const a=this;this.config={},this.init=function(){i.insertChat(),i.loadMessageHistory(),i.autoSizeWidth(),i.sendingToChat(),i.sendingUsingEnter(),i.textareaCancelNewlineOn(),i.openChat(),i.closeChat(),i.resizeChatWidth(),i.textareaAutoHeight(),i.checkFirstOpening.init(),i.chatAutoStart.init(),i.iconForUnreadMessage.checkNotifLocaleStorage(),i.insertMetaTag(),i.record.init(),i.files.init()},this.checkFirstOpening={init(){this.setHandler()},isOpened:!1,setHandler(){a.chatBubble.addEventListener("click",this.handler)},handler(){a.checkFirstOpening.isOpened=!0,this.removeEventListener("click",a.checkFirstOpening.handler)}},this.insertChat=function(n){document.head.insertAdjacentHTML("beforeend",'<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">');const t=document.createElement("style");t.innerHTML=e(a),document.head.appendChild(t);const s=document.createElement("div");s.id="chat-widget-container",s.classList.add("chat-widget-container"),document.body.appendChild(s),s.innerHTML='\n      <div id="chat-bubble" class="chat-bubble">\n        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48" fill="none">\n          <path d="M28.9467 47.6504C39.8283 45.3546 48 35.6374 48 23.9985C48 23.5096 47.9856 23.0241 47.9571 22.5424C47.863 23.2354 47.7271 23.9192 47.5483 24.5888C45.6352 31.5183 39.6418 37.3533 33.0557 40.1203C30.3006 41.2657 27.3378 41.9074 24.3574 41.8351C22.5851 41.8048 20.8193 41.486 19.1253 40.9874C13.4123 39.3954 8.85917 35.1162 7.72156 29.256C7.01644 25.8175 7.46243 22.2029 9.21993 19.115C12.8961 12.5059 20.8174 8.18246 28.4957 9.62973C29.8207 9.85743 31.1328 10.2395 32.4238 10.7261C31.2931 9.94074 30.0561 9.28084 28.7421 8.76759C19.1946 4.99007 6.8639 11.7986 2.80201 20.8217C0.748435 25.489 0.750206 29.4275 2.6052 34.1583C5.54037 41.7517 13.9216 46.8197 21.8565 47.8244C24.2407 48.1133 26.6228 48.0391 28.9467 47.6504Z" fill="white"/>\n          <path d="M18.2828 0.522731C20.8994 -0.0127422 23.6003 -0.15204 26.304 0.17563C34.2389 1.18032 42.6201 6.24833 45.5553 13.8417C47.4103 18.5725 47.4121 22.511 45.3585 27.1783C41.2966 36.2014 28.9659 43.0099 19.4184 39.2324C18.1044 38.7192 16.8674 38.0592 15.7367 37.2739C17.0277 37.7605 18.3399 38.1426 19.6648 38.3703C27.3431 39.8175 35.2644 35.494 38.9406 28.8849C40.6981 25.7971 41.1441 22.1825 40.4389 18.744C39.3013 12.8837 34.7482 8.6046 29.0352 7.01258C27.3412 6.51402 25.5754 6.19519 23.8031 6.16485C20.8227 6.09256 17.8599 6.73432 15.1048 7.8797C8.5187 10.6467 2.52536 16.4817 0.61222 23.4112C0.36021 24.3548 0.193617 25.3265 0.108591 26.3124C0.036746 25.5509 0 24.779 0 23.9985C0 12.636 7.78824 3.10505 18.2828 0.522731Z" fill="white"/>\n          <path d="M20.6106 23.2427C20.6252 23.2045 20.6332 23.1714 20.6339 23.1418C20.6346 23.1173 20.6077 23.1022 20.5866 23.1152C19.6913 23.6858 18.5157 24.0972 17.4705 23.9661C15.5888 23.7298 14.3026 21.7383 15.4207 20.03C15.4928 19.9197 15.6711 19.7079 15.9557 19.3945C16.506 18.7871 16.8663 18.2266 17.0759 17.4355C17.2616 16.7344 17.4362 16.1306 17.6008 15.6227C18.3738 13.2364 20.3187 11.6505 22.8554 11.4027C25.3798 11.1563 27.8656 12.147 29.3847 14.15C30.2356 15.2718 30.5202 16.5291 30.24 17.9225C30.1976 18.1319 30.1265 18.3749 30.0534 18.6251C29.9947 18.8261 29.9346 19.0317 29.8869 19.2281C29.7493 19.798 30.24 20.5286 30.561 21.0012C30.6796 21.1749 30.7407 21.3103 30.7451 21.4069C30.7625 21.7415 30.2616 21.87 29.9437 21.9515C29.9016 21.9623 29.8627 21.9723 29.8287 21.9818C29.7741 21.9969 29.7413 22.051 29.7537 22.1057C29.801 22.319 29.8571 22.5229 29.9211 22.7182C29.943 22.7852 29.9117 22.8471 29.828 22.9033C29.7312 22.9689 29.6387 23.0294 29.5514 23.0849C29.5193 23.1051 29.5121 23.1483 29.5361 23.1779C29.7178 23.398 29.5142 23.5933 29.3493 23.7514C29.3134 23.7859 29.2793 23.8186 29.2515 23.8494C29.2362 23.8659 29.226 23.8875 29.2224 23.9106C29.2115 23.9797 29.2042 24.0527 29.1968 24.1258C29.1824 24.2691 29.168 24.4131 29.127 24.531C28.9421 25.0605 28.5374 25.3285 27.9129 25.335C27.0911 25.3444 26.3836 25.2032 25.6134 25.0324C25.3041 24.9633 25.0835 24.9424 24.9503 24.969C24.4415 25.0713 24.1329 25.6679 23.9378 26.0808C23.5251 26.9547 23.2492 27.8222 23.1109 28.6818C23.028 29.1969 23.183 29.6379 23.5753 30.0046C24.2785 30.661 24.9518 31.3455 25.5945 32.058C26.5444 33.1114 27.4521 34.6345 27.4514 36.0986C27.4514 36.1231 27.4354 36.1447 27.4121 36.1519C27.3036 36.1872 27.1369 36.2305 26.9127 36.2809C25.7838 36.5338 24.681 36.6786 23.603 36.7139C19.0988 36.8602 14.767 35.4833 11.8496 31.942C11.8038 31.8866 11.7659 31.8008 11.7354 31.6834C11.7295 31.661 11.731 31.6387 11.7397 31.6171C12.2704 30.3159 13.0783 29.2423 14.1636 28.3972C14.4373 28.1839 14.8457 27.9267 15.3894 27.6248C15.6272 27.4928 15.852 27.3695 16.0666 27.2518C17.1569 26.6536 17.9837 26.2 18.9081 25.4957C19.6876 24.902 20.2547 24.1512 20.6106 23.2427Z" fill="white"/>\n        </svg>\n        <div id="chat-unread-message-icon" class="chat-unread-message-icon hidden"></div>\n      </div>\n      <div id="chat-popup" class="chat-popup hidden ">\n      <div id="chat-header" class="chat-header">\n          <div>\n            <h3>'.concat(i.config.chat_title,'</h3>\n            <div class="chat-status">\n              <div class="chat-online">Онлайн</div>\n            </div>\n            \n          </div>\n          <button id="close-popup">\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">\n              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />\n            </svg>\n          </button>\n        </div>\n        <div id="chat-messages" class="chat-messages">\n          <div id="chat-history" class="chat-history"></div>\n        </div>\n        <div id="chat-input-container" class="chat-input-container">\n          <div id="chat-input-container-inner" class="chat-input-container-inner">\n            <div class="chat-stack">\n              <div class="textarea-wrapper">\n\n                <div class="clip-container">\n                  <div id="clip-select" class="clip-select hidden">\n                    <div id="send-image" class="clip-select-item">\n                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                        <path fill-rule="evenodd" clip-rule="evenodd" d="M5 3.25C4.53587 3.25 4.09075 3.43437 3.76256 3.76256C3.43437 4.09075 3.25 4.53587 3.25 5V11.5227L6.13634 8.63633L6.14663 8.62624C6.6459 8.14579 7.25644 7.85854 7.91667 7.85854C8.57689 7.85854 9.18743 8.14579 9.68671 8.62624L9.697 8.63633L11.6667 10.606L11.9697 10.303L11.98 10.2929C12.4792 9.81246 13.0898 9.52521 13.75 9.52521C14.4102 9.52521 15.0208 9.81246 15.52 10.2929L15.5303 10.303L16.75 11.5227V5C16.75 4.53587 16.5656 4.09075 16.2374 3.76256C15.9092 3.43437 15.4641 3.25 15 3.25H5ZM16.75 13.644L14.4752 11.3692C14.203 11.1091 13.9519 11.0252 13.75 11.0252C13.5481 11.0252 13.297 11.1091 13.0248 11.3692L12.7273 11.6667L13.8637 12.803C14.1566 13.0959 14.1566 13.5708 13.8637 13.8637C13.5708 14.1566 13.0959 14.1566 12.803 13.8637L11.137 12.1976C11.1368 12.1974 11.1365 12.1972 11.1363 12.197C11.1361 12.1968 11.1359 12.1966 11.1357 12.1964L8.64185 9.70251C8.36964 9.44239 8.1186 9.35854 7.91667 9.35854C7.71474 9.35854 7.4637 9.44239 7.19148 9.70251L3.25 13.644V15C3.25 15.4641 3.43437 15.9092 3.76256 16.2374C4.09075 16.5656 4.53587 16.75 5 16.75H15C15.4641 16.75 15.9092 16.5656 16.2374 16.2374C16.5656 15.9092 16.75 15.4641 16.75 15V13.644ZM1.75 13.3333V15C1.75 15.862 2.09241 16.6886 2.7019 17.2981C3.3114 17.9076 4.13805 18.25 5 18.25H15C15.862 18.25 16.6886 17.9076 17.2981 17.2981C17.9076 16.6886 18.25 15.862 18.25 15V5C18.25 4.13805 17.9076 3.3114 17.2981 2.7019C16.6886 2.09241 15.862 1.75 15 1.75H5C4.13805 1.75 3.3114 2.09241 2.7019 2.7019C2.09241 3.3114 1.75 4.13805 1.75 5V13.3333ZM11.75 6.66667C11.75 6.25245 12.0858 5.91667 12.5 5.91667H12.5083C12.9225 5.91667 13.2583 6.25245 13.2583 6.66667C13.2583 7.08088 12.9225 7.41667 12.5083 7.41667H12.5C12.0858 7.41667 11.75 7.08088 11.75 6.66667Z" fill="#2A63EF"/>\n                      </svg>\n                      Изображение\n                    </div>\n                    <div class="clip-select-item">\n                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                        <path fill-rule="evenodd" clip-rule="evenodd" d="M5.83366 3.25C5.59054 3.25 5.35739 3.34658 5.18548 3.51849C5.01357 3.69039 4.91699 3.92355 4.91699 4.16667V15.8333C4.91699 16.0764 5.01357 16.3096 5.18548 16.4815C5.35739 16.6534 5.59054 16.75 5.83366 16.75H14.167C14.4101 16.75 14.6433 16.6534 14.8152 16.4815C14.9871 16.3096 15.0837 16.0764 15.0837 15.8333V7.41667H12.5003C12.0804 7.41667 11.6777 7.24985 11.3807 6.95292C11.0838 6.65599 10.917 6.25326 10.917 5.83333V3.25H5.83366ZM12.417 4.31066L14.023 5.91667H12.5003C12.4782 5.91667 12.457 5.90789 12.4414 5.89226C12.4258 5.87663 12.417 5.85543 12.417 5.83333V4.31066ZM4.12482 2.45783C4.57803 2.00461 5.19272 1.75 5.83366 1.75H11.667C11.8659 1.75 12.0567 1.82902 12.1973 1.96967L16.364 6.13634C16.5046 6.27699 16.5837 6.46775 16.5837 6.66667V15.8333C16.5837 16.4743 16.329 17.089 15.8758 17.5422C15.4226 17.9954 14.8079 18.25 14.167 18.25H5.83366C5.19272 18.25 4.57803 17.9954 4.12482 17.5422C3.6716 17.089 3.41699 16.4743 3.41699 15.8333V4.16667C3.41699 3.52573 3.6716 2.91104 4.12482 2.45783ZM6.75033 10.8333C6.75033 10.4191 7.08611 10.0833 7.50033 10.0833H12.5003C12.9145 10.0833 13.2503 10.4191 13.2503 10.8333C13.2503 11.2475 12.9145 11.5833 12.5003 11.5833H7.50033C7.08611 11.5833 6.75033 11.2475 6.75033 10.8333ZM6.75033 14.1667C6.75033 13.7525 7.08611 13.4167 7.50033 13.4167H12.5003C12.9145 13.4167 13.2503 13.7525 13.2503 14.1667C13.2503 14.5809 12.9145 14.9167 12.5003 14.9167H7.50033C7.08611 14.9167 6.75033 14.5809 6.75033 14.1667Z" fill="#2A63EF"/>\n                      </svg>\n                      Файл\n                    </div>\n                  </div>\n                  <button id="clip" class="clip">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">\n                      <path fill-rule="evenodd" clip-rule="evenodd" d="M11.4699 3.46963C12.4062 2.53333 13.6761 2.00732 15.0002 2.00732C16.3243 2.00732 17.5942 2.53333 18.5305 3.46963C19.4668 4.40594 19.9928 5.67583 19.9928 6.99996C19.9928 8.3241 19.4668 9.59399 18.5305 10.5303L12.0305 17.0303C11.492 17.5688 10.7617 17.8713 10.0002 17.8713C9.23867 17.8713 8.50834 17.5688 7.96986 17.0303C7.43139 16.4918 7.12887 15.7615 7.12887 15C7.12887 14.2384 7.43139 13.5081 7.96986 12.9696L14.4699 6.46963C14.7628 6.17674 15.2376 6.17674 15.5305 6.46963C15.8234 6.76253 15.8234 7.2374 15.5305 7.53029L9.03052 14.0303C8.77335 14.2875 8.62887 14.6363 8.62887 15C8.62887 15.3637 8.77335 15.7125 9.03052 15.9696C9.28769 16.2268 9.6365 16.3713 10.0002 16.3713C10.3639 16.3713 10.7127 16.2268 10.9699 15.9696L17.4699 9.46963C18.1249 8.81464 18.4928 7.92627 18.4928 6.99996C18.4928 6.07366 18.1249 5.18529 17.4699 4.53029C16.8149 3.8753 15.9265 3.50732 15.0002 3.50732C14.0739 3.50732 13.1855 3.8753 12.5305 4.53029L6.03052 11.0303C4.9777 12.0831 4.38623 13.511 4.38623 15C4.38623 16.4889 4.9777 17.9168 6.03052 18.9696C7.08334 20.0225 8.51128 20.6139 10.0002 20.6139C11.4891 20.6139 12.917 20.0225 13.9699 18.9696L20.4699 12.4696C20.7628 12.1767 21.2376 12.1767 21.5305 12.4696C21.8234 12.7625 21.8234 13.2374 21.5305 13.5303L15.0305 20.0303C13.6964 21.3644 11.8869 22.1139 10.0002 22.1139C8.11345 22.1139 6.30399 21.3644 4.96986 20.0303C3.63573 18.6962 2.88623 16.8867 2.88623 15C2.88623 13.1132 3.63573 11.3038 4.96986 9.96963L11.4699 3.46963Z" fill="#9C9EAD"/>\n                    </svg>\n                  </button>\n                </div>\n                \n                <textarea id="chat-input" class="chat-input" placeholder="Написать сообщение..."></textarea>\n                <button id="record-start" class="record">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">\n                    <path fill-rule="evenodd" clip-rule="evenodd" d="M7.25021 6C7.25021 3.37665 9.37686 1.25 12.0002 1.25C14.6236 1.25 16.7502 3.37665 16.7502 6V10C16.7502 12.6234 14.6236 14.75 12.0002 14.75C9.37686 14.75 7.25021 12.6234 7.25021 10V6ZM12.0002 2.75C10.2053 2.75 8.75021 4.20507 8.75021 6V10C8.75021 11.7949 10.2053 13.25 12.0002 13.25C13.7951 13.25 15.2502 11.7949 15.2502 10V6C15.2502 4.20507 13.7951 2.75 12.0002 2.75ZM4.69489 13.3508C5.05344 13.1434 5.51223 13.2659 5.71964 13.6244C6.97433 15.7934 9.3176 17.25 12.0002 17.25C14.6828 17.25 17.026 15.7934 18.2807 13.6244C18.4881 13.2659 18.9469 13.1434 19.3055 13.3508C19.664 13.5582 19.7865 14.017 19.5791 14.3755C18.1852 16.7851 15.6729 18.4701 12.7502 18.7183L12.7502 21C12.7502 21.4142 12.4144 21.75 12.0002 21.75C11.586 21.75 11.2502 21.4142 11.2502 21L11.2502 18.7183C8.32749 18.4701 5.81512 16.7851 4.42123 14.3755C4.21383 14.017 4.33635 13.5582 4.69489 13.3508Z" fill="#9C9EAD"/>\n                  </svg>\n                </button>\n              </div>\n            </div>\n            <button id="chat-submit" class="chat-submit">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n                <path d="M12 5V19M12 5L18 11M12 5L6 11" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </button>\n          </div>\n          <div id="record-wrapper" class="record-wrapper hidden">\n            <button id="record-stop" class="record-stop">\n              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">\n                <path d="M18 6L6 18M6 6L18 18" stroke="#9C9EAD" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </button>\n            <div class="record-container">\n              <div id="audio-play" class="audio-play hidden">\n                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="white"><g><path d="M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z"/></g></svg>\n              </div>\n              <div id="audio-pause" class="audio-pause hidden">\n                <svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 0 32 32" width="16" fill="white"><defs><style>.cls-1{fill:none;}</style></defs><title/><path d="M12,6H10A2,2,0,0,0,8,8V24a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2Z"/><path d="M22,6H20a2,2,0,0,0-2,2V24a2,2,0,0,0,2,2h2a2,2,0,0,0,2-2V8a2,2,0,0,0-2-2Z"/><rect class="cls-1" data-name="&lt;Transparent Rectangle&gt;" height="32" id="_Transparent_Rectangle_" width="32"/></svg>\n              </div>\n              <div id="audio-stop" class="audio-stop">\n                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n                  <path d="M4.5 13.5C3.39543 13.5 2.5 12.6046 2.5 11.5V4.5C2.5 3.39543 3.39543 2.5 4.5 2.5H11.5C12.6046 2.5 13.5 3.39543 13.5 4.5V11.5C13.5 12.6046 12.6046 13.5 11.5 13.5H4.5Z" fill="white"/>\n                </svg>\n              </div>\n              <div id="record-road" class="road"></div>\n              <div id="timer" class="timer">00:00</div>\n            </div>\n            <button id="chat-submit-record" class="chat-submit chat-submit-record">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n                <path d="M12 5V19M12 5L18 11M12 5L6 11" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>\n              </svg>\n            </button>\n          </div>\n          <a href="https://maia.work/" class="chat-lath" target="_blank">\n            <div class="chat-lath-text">Работает на</div>\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none">\n              <path d="M9.64983 15.9697C13.2766 15.2041 16 11.9653 16 8.08598C16 7.923 15.9952 7.76115 15.9857 7.60056C15.9543 7.83156 15.909 8.05948 15.8494 8.28268C15.2117 10.5925 13.2139 12.5375 11.0186 13.4599C10.1002 13.8416 9.1126 14.0556 8.11912 14.0315C7.52838 14.0214 6.93978 13.9151 6.37509 13.7489C4.47078 13.2182 2.95306 11.7918 2.57385 9.83843C2.33881 8.69225 2.48747 7.4874 3.07331 6.45811C4.29869 4.25507 6.93915 2.81391 9.49857 3.29634C9.94022 3.37224 10.3776 3.49958 10.8079 3.66179C10.431 3.40001 10.0187 3.18004 9.58071 3.00896C6.39819 1.74978 2.28797 4.01929 0.934004 7.02699C0.249478 8.58277 0.250069 9.89558 0.868401 11.4725C1.84679 14.0036 4.64054 15.693 7.28551 16.0279C8.08055 16.1242 8.87488 16.0994 9.64983 15.9697Z" fill="#A9ABBA"/>\n              <path d="M6.09525 0.260467C6.96715 0.082143 7.86711 0.0357871 8.76799 0.144969C11.413 0.479865 14.2067 2.1692 15.1851 4.70033C15.8034 6.27727 15.804 7.59007 15.1195 9.14586C13.7655 12.1536 9.65531 14.4231 6.47279 13.1639C6.0348 12.9928 5.62248 12.7728 5.24557 12.5111C5.67589 12.6733 6.11328 12.8006 6.55493 12.8765C9.11435 13.3589 11.7548 11.9178 12.9802 9.71474C13.566 8.68544 13.7147 7.48059 13.4796 6.33442C13.1004 4.38101 11.5827 2.95463 9.67841 2.42395C9.11372 2.25777 8.52512 2.15149 7.93438 2.14138C6.9409 2.11728 5.95329 2.3312 5.03493 2.71299C2.83957 3.63531 0.841786 5.58032 0.204073 7.89017C0.120068 8.20469 0.0645366 8.5286 0.0361951 8.85724C0.012248 8.60341 0 8.34613 0 8.08598C0 4.29811 2.59657 1.12089 6.09525 0.260467Z" fill="#A9ABBA"/>\n              <path d="M6.8702 7.83399C6.87505 7.82126 6.87772 7.81021 6.87796 7.80037C6.87821 7.7922 6.86923 7.78716 6.86219 7.79148C6.56376 7.98169 6.1719 8.11883 5.82348 8.07512C5.19628 7.99634 4.76755 7.33252 5.14023 6.76308C5.16425 6.72634 5.2237 6.65573 5.31857 6.55126C5.502 6.3488 5.6221 6.16195 5.69198 5.89824C5.75385 5.66456 5.81208 5.4633 5.86692 5.29398C6.12459 4.49855 6.7729 3.96994 7.61848 3.88732C8.45993 3.80519 9.28852 4.13542 9.79489 4.80308C10.0785 5.17702 10.1734 5.59611 10.08 6.0606C10.0659 6.13038 10.0422 6.21139 10.0178 6.29478C9.99823 6.36176 9.97819 6.43031 9.96231 6.49578C9.91645 6.68575 10.08 6.92928 10.187 7.08683C10.2265 7.14471 10.2469 7.18986 10.2484 7.22204C10.2542 7.3336 10.0872 7.37642 9.98124 7.4036C9.96721 7.4072 9.95425 7.41052 9.94289 7.4137C9.9247 7.41874 9.91378 7.43675 9.91791 7.45501C9.93368 7.5261 9.95236 7.59406 9.97371 7.65915C9.98099 7.68148 9.97055 7.70214 9.94265 7.72087C9.91038 7.74273 9.87957 7.7629 9.85045 7.78139C9.83978 7.78812 9.83735 7.80253 9.84536 7.81238C9.90593 7.88574 9.83806 7.95085 9.7831 8.00357C9.77113 8.01505 9.75977 8.02595 9.75049 8.03621C9.74539 8.04173 9.742 8.04894 9.74078 8.05662C9.73718 8.07967 9.73473 8.10398 9.73228 8.12835C9.72748 8.17611 9.72265 8.22414 9.709 8.26341C9.64737 8.43993 9.51246 8.52927 9.30429 8.53143C9.03035 8.53456 8.79452 8.48748 8.53781 8.43056C8.43469 8.40751 8.36117 8.40054 8.31677 8.40943C8.14717 8.44353 8.0443 8.64239 7.97927 8.78001C7.8417 9.07133 7.74974 9.36049 7.70364 9.64701C7.67598 9.81873 7.72766 9.96571 7.85844 10.088C8.09282 10.3068 8.31726 10.5349 8.5315 10.7724C8.84814 11.1236 9.1507 11.6313 9.15046 12.1193C9.15046 12.1275 9.14512 12.1347 9.13736 12.1371C9.1012 12.1488 9.04564 12.1632 8.97091 12.1801C8.59459 12.2644 8.227 12.3126 7.86766 12.3244C6.36625 12.3731 4.92235 11.9142 3.94988 10.7338C3.93459 10.7153 3.92197 10.6867 3.91178 10.6475C3.90984 10.6401 3.91033 10.6327 3.91324 10.6255C4.09012 10.1917 4.35944 9.83386 4.72121 9.55215C4.81244 9.48106 4.94855 9.39532 5.1298 9.29469C5.20911 9.25067 5.2841 9.20953 5.35566 9.17027C5.71912 8.97087 5.99456 8.81976 6.30268 8.58499C6.56254 8.3871 6.75155 8.13684 6.8702 7.83399Z" fill="#A9ABBA"/>\n            </svg>\n            <div class="chat-lath-text">MAIA</div>\n          </a>\n        </div>\n      </div>\n    '),i.elementSearch()},this.elementSearch=function(){i.chatInput=document.getElementById("chat-input"),i.chatSubmit=document.getElementById("chat-submit"),i.chatMessages=document.getElementById("chat-messages"),i.chatBubble=document.getElementById("chat-bubble"),i.chatPopup=document.getElementById("chat-popup"),i.closePopup=document.getElementById("close-popup"),i.chatHistory=document.getElementById("chat-history"),i.chatInputContainerInner=document.getElementById("chat-input-container-inner"),i.recordWrapper=document.getElementById("record-wrapper"),i.recordRoad=document.getElementById("record-road"),i.recordStart=document.getElementById("record-start"),i.recordStop=document.getElementById("record-stop"),i.audioPlay=document.getElementById("audio-play"),i.audioPause=document.getElementById("audio-pause"),i.audioStop=document.getElementById("audio-stop"),i.timer=document.getElementById("timer"),i.chatSubmitRecord=document.getElementById("chat-submit-record"),i.clip=document.getElementById("clip"),i.clipSelect=document.getElementById("clip-select"),i.sendImage=document.getElementById("send-image")},this.autoSizeWidth=function(){window.innerWidth<768||i.chatMessages.clientHeight<i.chatMessages.scrollHeight&&(i.chatMessages.style.paddingRight="13px")},this.messagesContainerCheckWidth=function(){window.innerWidth>768&&i.chatMessages.clientHeight<i.chatMessages.scrollHeight?i.chatMessages.style.paddingRight="13px":i.chatMessages.style.paddingRight="16px"},this.resizeChatWidth=function(){window.addEventListener("resize",(function(){i.messagesContainerCheckWidth()}))},this.textareaCheckHeight=function(){i.chatInput.style.height="36px",i.chatInput.style.height=i.chatInput.scrollHeight+"px"},this.textareaAutoHeight=function(){i.chatInput.addEventListener("input",(function(){i.textareaCheckHeight()}))},this.sendingToChat=function(){i.chatSubmit.addEventListener("click",(async function(){const e=i.chatInput.value.trim();e&&(i.chatMessages.scrollTop=i.chatMessages.scrollHeight,i.onUserRequest(e),a.prints.printsAdd(),i.autoSizeWidth(),i.textareaCheckHeight())}))},this.sendingUsingEnter=function(){i.chatInput.addEventListener("keyup",(function(e){"Enter"===e.key&&(i.chatSubmit.click(),i.autoSizeWidth())}))},this.textareaCancelNewlineOn=function(){i.chatInput.addEventListener("keydown",(function(e){"Enter"===e.key&&e.preventDefault()}))},this.openChat=function(){i.chatBubble.addEventListener("click",(function(){i.togglePopup()}))},this.closeChat=function(){i.closePopup.addEventListener("click",(function(){i.togglePopup()}))},this.togglePopup=function(){i.chatPopup.classList.toggle("hidden")},this.scrollWindowToBottom=function(){i.chatPopup.classList.remove("hidden"),i.chatMessages.scrollTop=i.chatMessages.scrollHeight,i.chatPopup.classList.add("hidden")},this.chatAutoStart={init(){this.setTimeoutAutoStart()},setTimeoutAutoStart(){a.config?.seconds_to_autostart&&setTimeout((function(){a.checkFirstOpening.isOpened||a.chatPopup.classList.contains("hidden")&&a.chatBubble.click()}),1e3*a.config?.seconds_to_autostart)}},this.userMessageAppend=function(e){const n=i.getUserMessage(e);i.chatMessages.appendChild(n),i.chatMessages.scrollTop=i.chatMessages.scrollHeight,i.chatInput.value=""},this.onUserRequest=function(e){try{i.userMessageAppend(e),i.ws.send(JSON.stringify({action:"MESSAGE",session_id:localStorage.getItem("session_id"),message:e}))}catch(e){}},this.getBotMessage=function(e){const n=a.convertingFunction.parseLinks(e),t=document.createElement("div");return t.className="flex mb-3 chat-message-bot-container",t.innerHTML='<div class="chat-message-bot">'.concat(n,"</div>"),t},this.getUserMessage=function(e){const n=document.createElement("div");return n.className="chat-message-user-container",n.innerHTML='<div class="chat-message-user">'.concat(e,"</div>"),n},this.loadMessageHistory=function(){i.config.conversation_history.forEach((function(e){let{author:n,message:t}=e;i.chatHistory.append("USER"===n?i.getUserMessage(t):i.getBotMessage(t))})),i.scrollWindowToBottom()},this.reply=function(e){i.messageSound.audioPlay();const n=i.getBotMessage(e);i.chatMessages.appendChild(n),i.chatMessages.scrollTop=i.chatMessages.scrollHeight,i.autoSizeWidth()},this.openWebSoket=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"apidev.maia.work";const{appId:n,apiHash:t}=document.querySelector("#maia-chat-widget").dataset;i.ws=new WebSocket("wss://".concat(e,"/api/v1/webhook/chat_widget?app_id=").concat(n,"&api_hash=").concat(t)),i.webSocketOpenHandler(),i.webSocketMessageHandler(),i.webSocketCloseHandler(),i.websocketClosure()},this.webSocketOpenHandler=function(){i.ws.onopen=function(e){i.ws.send(JSON.stringify({action:"INIT",session_id:localStorage.getItem("session_id")?localStorage.getItem("session_id"):void 0}))}},this.webSocketMessageHandler=function(){i.ws.onmessage=function(e){const n=JSON.parse(JSON.parse(e.data));"INIT"===n.action&&(localStorage.getItem("session_id")||localStorage.setItem("session_id",n.session_id),i.writingDataToConfig(n),i.init(),i.messageSound.init(),i.iconForUnreadMessage.init()),"MESSAGE"===n.action&&(i.reply(n.answer),i.iconForUnreadMessage.messageCheck(),a.prints.printsRemove())}},this.webSocketCloseHandler=function(){i.ws.onclose=function(e){i?.chatInput?.setAttribute("disabled",!0)}},this.websocketClosure=function(){document.addEventListener("unload",(function(){i.ws.close()}))},this.writingDataToConfig=function(e){i.config={...i.config,salesperson_name:e.salesperson_name,salesperson_role:e.salesperson_role,chat_title:e.chat_title,circle_color:e.circle_color,header_color:e.header_color,seconds_to_autostart:e.seconds_to_autostart,send_button_color:e.send_button_color,user_message_color:e.user_message_color,widget_location:e.widget_location,conversation_history:e.conversation_history,allowed_domains:e.allowed_domains}},this.checkDomen=function(){return!!window.location.href.includes(i.config.allowed_domains[0])},this.prints={callArray:[],printsLoadingChoiceActionStart(){this.callArray.push(!0),1===this.callArray.length&&this.printsAdd()},printsLoadingChoiceActionFinish(){1===this.callArray.length&&this.printsRemove(),this.callArray.pop()},printsAdd(){const e=document.querySelector(".chat-status");e.querySelector("[data-chat-prints-loading]")||e.prepend(this.getPrintsHTML())},printsRemove(){const e=document.querySelector(".chat-status [data-chat-prints-loading]");e?.remove()},getPrintsHTML(){const e=document.createElement("div");return e.innerHTML='<div class="chat-prints" data-chat-prints-loading>\n                                      <div class="chat-prints-circle-container">\n                                        <div class="chat-prints-circle chat-prints-circle-first"></div>\n                                          <div class="chat-prints-circle chat-prints-circle-second"></div>\n                                            <div class="chat-prints-circle chat-prints-circle-third"></div>\n                                          </div>\n                                          печатает\n                                      </div>',e.firstElementChild}},this.messageSound={init(){this.createAudio()},createAudio(){var e=this;this.sound=document.createElement("audio"),this.sound.src="https://b6905acf-5120-4e0c-b3ea-3716bba15c68.selstorage.ru/message_sound.mp3",this.sound.addEventListener("error",(function(){e.sound=null}))},audioPlay(){this.sound&&(this.sound.paused||(this.sound.pause(),this.sound.currentTime=0),this.sound.play())}},this.iconForUnreadMessage={init(){this.chatOpenHandler()},messageCheck(){this.closeСheck()&&(this.showIcon(),this.setNotifLocaleStorage())},closeСheck(){const e=document.querySelector("#chat-popup");if(e)return e.classList.contains("hidden")},showIcon(){const e=document.querySelector("#chat-unread-message-icon");e&&e.classList.remove("hidden")},setNotifLocaleStorage(){localStorage.setItem("unred-message",!0)},removeNotifLocaleStorage(){localStorage.removeItem("unred-message")},checkNotifLocaleStorage(){localStorage.getItem("unred-message")&&this.showIcon()},hiddenIcon(){const e=document.querySelector("#chat-unread-message-icon");e&&e.classList.add("hidden")},chatOpenHandler(){var e=this;const n=document.querySelector("#chat-bubble");n&&n.addEventListener("click",(function(){e.closeСheck()||(e.hiddenIcon(),e.removeNotifLocaleStorage())}))}},this.insertMetaTag=function(){let e=document.querySelector('meta[name="viewport"]');e||(e=document.createElement("meta"),e.name="viewport",document.getElementsByTagName("head")[0].appendChild(e)),e.content&&(e.content.includes(", user-scalable=no")?e.content="width=device-width, initial-scale=1.0, user-scalable=no":e.content+=", user-scalable=no")},this.record=n(a),this.files=t(a),this.convertingFunction={parseLinks(e){var n=n=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e.replace(n,(function(e){return'<a href="'+e+'" target="_blank">'+e+"</a>"}))}}}(new i).openWebSoket("api.maia.work")})();